<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="register.page_title">Register - Student Dashboard</title>
    <link rel="icon" type="image/png" href="UCIC L(1).png" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body class="login-page">
    <div class="login-wrapper">
      <div class="login-promo">
        <div class="promo-content">
          <div class="promo-logo">*</div>
          <h1 data-i18n="register.title">Buat Akun Anda</h1>
          <p data-i18n="register.subtitle">
            Daftar sekali dan kelola seluruh jadwal akademik Anda di satu
            tempat.
          </p>

          <div class="terminal-animation-container">
            <div class="mock-terminal">
              <div class="mock-terminal-header">
                <div class="mock-terminal-buttons">
                  <span class="mock-terminal-btn red"></span>
                  <span class="mock-terminal-btn yellow"></span>
                  <span class="mock-terminal-btn green"></span>
                </div>
              </div>
              <div class="mock-terminal-body">
                <div class="mock-shape-container pos-top-center">
                  <div class="mock-shape">
                    <div class="mock-text" id="mock-text-fullname"></div>
                  </div>
                </div>

                <div class="mock-shape-container pos-left-center">
                  <div class="mock-shape">
                    <div class="mock-text" id="mock-text-email"></div>
                  </div>
                </div>

                <div class="mock-shape-container pos-right-center">
                  <div class="mock-shape">
                    <div class="mock-text" id="mock-text-password"></div>
                  </div>
                </div>

                <div class="mock-shape-container pos-bottom-center">
                  <div class="mock-shape">
                    <div class="mock-text" id="mock-text-confirmpass"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="promo-footer">
            <p>Â© 2024 UCIC. All rights reserved.</p>
          </div>
        </div>
      </div>

      <div class="login-form-container">
        <div class="form-wrapper">
          <h3 class="form-logo-text">ðŸŽ“ Dashboard Mahasiswa</h3>
          <h2 data-i18n="register.welcome">Mulai Mendaftar</h2>

          <form class="login-form" id="registerForm">
            <div class="form-group">
              <label for="fullName" data-i18n="register.fullname"
                >Nama Lengkap</label
              >
              <input
                type="text"
                id="fullName"
                placeholder="Masukan Nama Lengkap"
                required
              />
            </div>
            <div class="form-group">
              <label for="email" data-i18n="register.email">Email</label>
              <input
                type="email"
                id="email"
                placeholder="Masukan Email"
                required
              />
            </div>
            <div class="form-group">
              <label for="password" data-i18n="register.password"
                >Password</label
              >
              <input
                type="password"
                id="password"
                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                required
              />
            </div>
            <div class="form-group">
              <label for="confirmPassword" data-i18n="register.confirm"
                >Konfirmasi Password</label
              >
              <input
                type="password"
                id="confirmPassword"
                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                required
              />
            </div>

            <button type="submit" data-i18n="register.button">Buat Akun</button>
            <div class="regis-footer-desktop">
              <p class="form-subtext">
                <span data-i18n="register.have_account">Sudah punya akun?</span>
                <a href="index.html" data-i18n="register.login_now"
                  >Masuk di sini</a
                >
              </p>
            </div>
          </form>

          <div class="regis-footer-mobile">
            <p class="form-subtext">
              <span data-i18n="register.have_account">Sudah punya akun?</span>
              <a href="index.html" data-i18n="register.login_now"
                >Masuk di sini</a
              >
            </p>
          </div>
        </div>
      </div>
    </div>

    <script>
      async function hashPassword(str) {
        const msgUint8 = new TextEncoder().encode(str);
        const hashBuffer = await crypto.subtle.digest("SHA-256", msgUint8);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map((b) => b.toString(16).padStart(2, "0")).join("");
      }

      document.addEventListener("DOMContentLoaded", function () {
        document
          .getElementById("registerForm")
          .addEventListener("submit", async function (e) {
            e.preventDefault();

            const fullName = document.getElementById("fullName").value;
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const confirmPassword =
              document.getElementById("confirmPassword").value;

            if (password !== confirmPassword) {
              alert("Password tidak sama!");
              return;
            }

            const users = JSON.parse(localStorage.getItem("users_db") || "[]");

            if (users.some((u) => u.email === email)) {
              alert("Email sudah terdaftar!");
              return;
            }

            const hashedPassword = await hashPassword(password);

            const newUser = {
              id: Date.now(),
              fullName: fullName,
              email: email,
              password: hashedPassword,
              nim: "202" + Math.floor(Math.random() * 10000),
              programStudi: "Informatics Engineering",
              semester: 1,
              year: new Date().getFullYear(),
            };

            users.push(newUser);
            localStorage.setItem("users_db", JSON.stringify(users));

            alert("Registrasi Berhasil! Silakan Login.");
            window.location.href = "index.html";
          });

        try {
          const fullNameInput = document.getElementById("fullName");
          const emailInput = document.getElementById("email");
          const passwordInput = document.getElementById("password");
          const confirmPasswordInput =
            document.getElementById("confirmPassword");

          const mockFullNameText =
            document.getElementById("mock-text-fullname");
          const mockEmailText = document.getElementById("mock-text-email");
          const mockPasswordText =
            document.getElementById("mock-text-password");
          const mockConfirmPassText = document.getElementById(
            "mock-text-confirmpass"
          );

          if (fullNameInput && mockFullNameText) {
            fullNameInput.addEventListener("input", (e) => {
              mockFullNameText.textContent = e.target.value;
            });
          }
          if (emailInput && mockEmailText) {
            emailInput.addEventListener("input", (e) => {
              mockEmailText.textContent = e.target.value;
            });
          }
          if (passwordInput && mockPasswordText) {
            passwordInput.addEventListener("input", (e) => {
              mockPasswordText.textContent = "â€¢".repeat(e.target.value.length);
            });
          }
          if (confirmPasswordInput && mockConfirmPassText) {
            confirmPasswordInput.addEventListener("input", (e) => {
              mockConfirmPassText.textContent = "â€¢".repeat(
                e.target.value.length
              );
            });
          }
        } catch (error) {
          console.error("Gagal inisialisasi animasi terminal:", error);
        }
      });
    </script>
  </body>
</html>
